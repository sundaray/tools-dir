{"version":3,"file":"httpServer.js","names":["MultipartNode","Cookies","Etag","FileSystem","App","IncomingMessage","Server","Error","ServerRequest","Socket","Chunk","Config","Effect","FiberSet","pipe","Layer","Option","Runtime","Scope","Stream","Http","Readable","pipeline","WS","NodeContext","NodeHttpClient","HttpIncomingMessageImpl","internalPlatform","make","evaluate","options","gen","scope","server","acquireRelease","sync","async","resume","listening","void","close","error","die","onError","cause","fail","ServeError","on","listen","off","address","wss","WebSocketServer","noServer","extend","cached","_tag","path","hostname","port","serve","httpApp","middleware","handler","makeHandler","upgradeHandler","makeUpgradeHandler","addFinalizer","provideService","MaxBodySize","some","Size","handledApp","toHandled","handleResponse","map","runtime","runFork","nodeRequest","nodeResponse","fiber","HttpServerRequest","ServerRequestImpl","writableEnded","unsafeInterruptAsFork","clientAbortFiberId","lazyWss","makeRuntime","socket","head","nodeResponse_","undefined","ServerResponse","assignSocket","end","upgradeEffect","fromWebSocket","flatMap","handleUpgrade","ws","succeed","source","response","url","headersOverride","TypeId","constructor","remoteAddressOverride","RequestError","request","reason","cachedCookies","cookies","parseHeader","headers","cookie","resolvedResponse","modify","remoteAddress","originalUrl","method","toUpperCase","multipartEffect","multipart","runSync","persisted","multipartStream","stream","upgrade","description","toString","toJSON","inspect","_id","layerServer","scoped","HttpServer","layerContext","mergeAll","layer","layerWeak","layerTest","layerTestClient","provide","layerWithoutAgent","makeAgentLayer","keepAlive","provideMerge","createServer","layerConfig","unwrap","suspend","isEmpty","toSet","toSetCookieHeaders","push","writeHead","status","body","tryPromise","try","signal","catch","ResponseError","interruptible","tapErrorCause","handleCause","r","Response","formData","Object","fromEntries","fromWeb","once","orDie","runForEachChunk","chunk","array","toReadonlyArray","length","i","write","matchCauseEffect","onSuccess","onFailure","causeResponse","headersSent","failCause","toIncomingMessage","self","toServerResponse","res"],"sources":["../../../src/internal/httpServer.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}