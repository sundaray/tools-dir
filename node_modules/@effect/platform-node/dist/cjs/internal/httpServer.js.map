{"version":3,"file":"httpServer.js","names":["MultipartNode","_interopRequireWildcard","require","Cookies","Etag","FileSystem","App","IncomingMessage","Server","Error","ServerRequest","Socket","Chunk","Config","Effect","FiberSet","_Function","Layer","Option","Runtime","Scope","Stream","Http","_nodeStream","_promises","WS","NodeContext","NodeHttpClient","_httpIncomingMessage","internalPlatform","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","make","evaluate","options","gen","scope","server","acquireRelease","sync","async","resume","listening","void","close","error","die","onError","cause","fail","ServeError","on","listen","off","address","wss","pipe","WebSocketServer","noServer","extend","cached","_tag","path","hostname","port","serve","httpApp","middleware","handler","makeHandler","upgradeHandler","makeUpgradeHandler","addFinalizer","provideService","MaxBodySize","some","Size","exports","handledApp","toHandled","handleResponse","map","runtime","runFork","nodeRequest","nodeResponse","fiber","HttpServerRequest","ServerRequestImpl","writableEnded","unsafeInterruptAsFork","clientAbortFiberId","lazyWss","makeRuntime","socket","head","nodeResponse_","undefined","ServerResponse","assignSocket","end","upgradeEffect","fromWebSocket","flatMap","handleUpgrade","ws","succeed","HttpIncomingMessageImpl","source","response","url","headersOverride","TypeId","constructor","remoteAddressOverride","RequestError","request","reason","cachedCookies","cookies","parseHeader","headers","cookie","resolvedResponse","modify","remoteAddress","originalUrl","method","toUpperCase","multipartEffect","multipart","runSync","persisted","multipartStream","stream","upgrade","description","toString","toJSON","inspect","_id","layerServer","scoped","HttpServer","layerContext","mergeAll","layer","layerWeak","layerTest","layerTestClient","provide","layerWithoutAgent","makeAgentLayer","keepAlive","provideMerge","createServer","layerConfig","unwrap","suspend","isEmpty","toSet","toSetCookieHeaders","push","writeHead","status","body","tryPromise","try","signal","pipeline","catch","ResponseError","interruptible","tapErrorCause","handleCause","Response","formData","fromEntries","Readable","fromWeb","once","orDie","runForEachChunk","chunk","array","toReadonlyArray","length","write","matchCauseEffect","onSuccess","onFailure","causeResponse","headersSent","failCause","toIncomingMessage","self","toServerResponse","res"],"sources":["../../../src/internal/httpServer.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}