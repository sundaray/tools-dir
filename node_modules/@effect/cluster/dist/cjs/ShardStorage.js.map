{"version":3,"file":"ShardStorage.js","names":["Arr","_interopRequireWildcard","require","Context","Effect","Layer","MutableHashMap","Option","_Runner","_RunnerAddress","_ShardId","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","ShardStorage","Tag","exports","makeEncoded","encoded","of","getAssignments","map","assignments","arr","empty","shardId","runnerAddress","push","ShardId","fromString","none","some","decodeRunnerAddress","saveAssignments","toString","isNone","encodeRunnerAddress","value","getRunners","gen","runners","results","length","address","runner","Runner","decodeSync","saveRunners","suspend","Array","from","encodeSync","acquire","shardIds","id","pipe","shards","refresh","release","releaseAll","layerNoop","sync","acquired","void","_address","succeed","makeMemory","layerMemory","effect","host","port","split","RunnerAddress","Number"],"sources":["../../src/ShardStorage.ts"],"sourcesContent":[null],"mappings":";;;;;;AAGA,IAAAA,GAAA,GAAAC,uBAAA,CAAAC,OAAA;AACA,IAAAC,OAAA,GAAAF,uBAAA,CAAAC,OAAA;AACA,IAAAE,MAAA,GAAAH,uBAAA,CAAAC,OAAA;AACA,IAAAG,KAAA,GAAAJ,uBAAA,CAAAC,OAAA;AACA,IAAAI,cAAA,GAAAL,uBAAA,CAAAC,OAAA;AACA,IAAAK,MAAA,GAAAN,uBAAA,CAAAC,OAAA;AAEA,IAAAM,OAAA,GAAAN,OAAA;AACA,IAAAO,cAAA,GAAAP,OAAA;AACA,IAAAQ,QAAA,GAAAR,OAAA;AAAsC,SAAAD,wBAAAU,CAAA,EAAAC,CAAA,6BAAAC,OAAA,MAAAC,CAAA,OAAAD,OAAA,IAAAE,CAAA,OAAAF,OAAA,YAAAZ,uBAAA,YAAAA,CAAAU,CAAA,EAAAC,CAAA,SAAAA,CAAA,IAAAD,CAAA,IAAAA,CAAA,CAAAK,UAAA,SAAAL,CAAA,MAAAM,CAAA,EAAAC,CAAA,EAAAC,CAAA,KAAAC,SAAA,QAAAC,OAAA,EAAAV,CAAA,iBAAAA,CAAA,uBAAAA,CAAA,yBAAAA,CAAA,SAAAQ,CAAA,MAAAF,CAAA,GAAAL,CAAA,GAAAG,CAAA,GAAAD,CAAA,QAAAG,CAAA,CAAAK,GAAA,CAAAX,CAAA,UAAAM,CAAA,CAAAM,GAAA,CAAAZ,CAAA,GAAAM,CAAA,CAAAO,GAAA,CAAAb,CAAA,EAAAQ,CAAA,gBAAAP,CAAA,IAAAD,CAAA,gBAAAC,CAAA,OAAAa,cAAA,CAAAC,IAAA,CAAAf,CAAA,EAAAC,CAAA,OAAAM,CAAA,IAAAD,CAAA,GAAAU,MAAA,CAAAC,cAAA,KAAAD,MAAA,CAAAE,wBAAA,CAAAlB,CAAA,EAAAC,CAAA,OAAAM,CAAA,CAAAK,GAAA,IAAAL,CAAA,CAAAM,GAAA,IAAAP,CAAA,CAAAE,CAAA,EAAAP,CAAA,EAAAM,CAAA,IAAAC,CAAA,CAAAP,CAAA,IAAAD,CAAA,CAAAC,CAAA,WAAAO,CAAA,KAAAR,CAAA,EAAAC,CAAA;AAZtC;;;;AAcA;;;;;;;AAOM,MAAOkB,YAAa,sBAAQ3B,OAAO,CAAC4B,GAAG,CAAC,8BAA8B,CAAC,EA2DzE;AAuEJ;;;;AAAAC,OAAA,CAAAF,YAAA,GAAAA,YAAA;AAIO,MAAMG,WAAW,GAAIC,OAAgB,IAC1CJ,YAAY,CAACK,EAAE,CAAC;EACdC,cAAc,EAAEhC,MAAM,CAACiC,GAAG,CAACH,OAAO,CAACE,cAAc,EAAGE,WAAW,IAAI;IACjE,MAAMC,GAAG,GAAGvC,GAAG,CAACwC,KAAK,EAA2C;IAChE,KAAK,MAAM,CAACC,OAAO,EAAEC,aAAa,CAAC,IAAIJ,WAAW,EAAE;MAClDC,GAAG,CAACI,IAAI,CAAC,CACPC,gBAAO,CAACC,UAAU,CAACJ,OAAO,CAAC,EAC3BC,aAAa,KAAK,IAAI,GAAGnC,MAAM,CAACuC,IAAI,EAAE,GAAGvC,MAAM,CAACwC,IAAI,CAACC,mBAAmB,CAACN,aAAa,CAAC,CAAC,CACzF,CAAC;IACJ;IACA,OAAOH,GAAG;EACZ,CAAC,CAAC;EACFU,eAAe,EAAGX,WAAW,IAAI;IAC/B,MAAMC,GAAG,GAAGvC,GAAG,CAACwC,KAAK,EAAoC;IACzD,KAAK,MAAM,CAACC,OAAO,EAAEC,aAAa,CAAC,IAAIJ,WAAW,EAAE;MAClDC,GAAG,CAACI,IAAI,CAAC,CACPF,OAAO,CAACS,QAAQ,EAAE,EAClB3C,MAAM,CAAC4C,MAAM,CAACT,aAAa,CAAC,GAAG,IAAI,GAAGU,mBAAmB,CAACV,aAAa,CAACW,KAAK,CAAC,CAC/E,CAAC;IACJ;IACA,OAAOnB,OAAO,CAACe,eAAe,CAACV,GAAG,CAAC;EACrC,CAAC;EACDe,UAAU,EAAElD,MAAM,CAACmD,GAAG,CAAC,aAAS;IAC9B,MAAMC,OAAO,GAAG,OAAOtB,OAAO,CAACoB,UAAU;IACzC,MAAMG,OAAO,GAAmC,EAAE;IAClD,KAAK,IAAIvC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGsC,OAAO,CAACE,MAAM,EAAExC,CAAC,EAAE,EAAE;MACvC,MAAM,CAACyC,OAAO,EAAEC,MAAM,CAAC,GAAGJ,OAAO,CAACtC,CAAC,CAAC;MACpC,IAAI;QACFuC,OAAO,CAACd,IAAI,CAAC,CAACK,mBAAmB,CAACW,OAAO,CAAC,EAAEE,cAAM,CAACC,UAAU,CAACF,MAAM,CAAC,CAAC,CAAC;MACzE,CAAC,CAAC,MAAM;QACN;MAAA;IAEJ;IACA,OAAOH,OAAO;EAChB,CAAC,CAAC;EACFM,WAAW,EAAGP,OAAO,IACnBpD,MAAM,CAAC4D,OAAO,CAAC,MACb9B,OAAO,CAAC6B,WAAW,CACjBE,KAAK,CAACC,IAAI,CAACV,OAAO,EAAE,CAAC,CAACG,OAAO,EAAEC,MAAM,CAAC,KAAK,CAACR,mBAAmB,CAACO,OAAO,CAAC,EAAEE,cAAM,CAACM,UAAU,CAACP,MAAM,CAAC,CAAC,CAAC,CACtG,CACF;EACHQ,OAAO,EAAEA,CAACT,OAAO,EAAEU,QAAQ,KAAI;IAC7B,MAAM9B,GAAG,GAAG0B,KAAK,CAACC,IAAI,CAACG,QAAQ,EAAGC,EAAE,IAAKA,EAAE,CAACpB,QAAQ,EAAE,CAAC;IACvD,OAAOhB,OAAO,CAACkC,OAAO,CAAChB,mBAAmB,CAACO,OAAO,CAAC,EAAEpB,GAAG,CAAC,CAACgC,IAAI,CAC5DnE,MAAM,CAACiC,GAAG,CAAEmC,MAAM,IAAKA,MAAM,CAACnC,GAAG,CAACO,gBAAO,CAACC,UAAU,CAAC,CAAC,CACvD;EACH,CAAC;EACD4B,OAAO,EAAEA,CAACd,OAAO,EAAEU,QAAQ,KAAI;IAC7B,MAAM9B,GAAG,GAAG0B,KAAK,CAACC,IAAI,CAACG,QAAQ,EAAGC,EAAE,IAAKA,EAAE,CAACpB,QAAQ,EAAE,CAAC;IACvD,OAAOhB,OAAO,CAACuC,OAAO,CAACrB,mBAAmB,CAACO,OAAO,CAAC,EAAEpB,GAAG,CAAC,CAACgC,IAAI,CAC5DnE,MAAM,CAACiC,GAAG,CAAEmC,MAAM,IAAKA,MAAM,CAACnC,GAAG,CAACO,gBAAO,CAACC,UAAU,CAAC,CAAC,CACvD;EACH,CAAC;EACD6B,OAAOA,CAACf,OAAO,EAAElB,OAAO;IACtB,OAAOP,OAAO,CAACwC,OAAO,CAACtB,mBAAmB,CAACO,OAAO,CAAC,EAAElB,OAAO,CAACS,QAAQ,EAAE,CAAC;EAC1E,CAAC;EACDyB,UAAUA,CAAChB,OAAO;IAChB,OAAOzB,OAAO,CAACyC,UAAU,CAACvB,mBAAmB,CAACO,OAAO,CAAC,CAAC;EACzD;CACD,CAAC;AAEJ;;;;AAAA3B,OAAA,CAAAC,WAAA,GAAAA,WAAA;AAIO,MAAM2C,SAAS,GAAA5C,OAAA,CAAA4C,SAAA,gBAA8BvE,KAAK,CAACwE,IAAI,CAC5D/C,YAAY,EACZ,MAAK;EACH,IAAIgD,QAAQ,GAAmB,EAAE;EACjC,OAAOhD,YAAY,CAACK,EAAE,CAAC;IACrBC,cAAc,EAAEhC,MAAM,CAACyE,IAAI,CAAC,MAAM,EAAE,CAAC;IACrC5B,eAAe,EAAEA,CAAA,KAAM7C,MAAM,CAAC2E,IAAI;IAClCzB,UAAU,EAAElD,MAAM,CAACyE,IAAI,CAAC,MAAM,EAAE,CAAC;IACjCd,WAAW,EAAEA,CAAA,KAAM3D,MAAM,CAAC2E,IAAI;IAC9BX,OAAO,EAAEA,CAACY,QAAQ,EAAER,MAAM,KAAI;MAC5BM,QAAQ,GAAGb,KAAK,CAACC,IAAI,CAACM,MAAM,CAAC;MAC7B,OAAOpE,MAAM,CAAC6E,OAAO,CAAChB,KAAK,CAACC,IAAI,CAACM,MAAM,CAAC,CAAC;IAC3C,CAAC;IACDC,OAAO,EAAEA,CAAA,KAAMrE,MAAM,CAACyE,IAAI,CAAC,MAAMC,QAAQ,CAAC;IAC1CJ,OAAO,EAAEA,CAAA,KAAMtE,MAAM,CAAC2E,IAAI;IAC1BJ,UAAU,EAAEA,CAAA,KAAMvE,MAAM,CAAC2E;GAC1B,CAAC;AACJ,CAAC,CACF;AAED;;;;AAIO,MAAMG,UAAU,GAAAlD,OAAA,CAAAkD,UAAA,gBAAG9E,MAAM,CAACmD,GAAG,CAAC,aAAS;EAC5C,MAAMjB,WAAW,GAAGhC,cAAc,CAACkC,KAAK,EAAyC;EACjF,MAAMgB,OAAO,GAAGlD,cAAc,CAACkC,KAAK,EAAyB;EAE7D,SAASS,eAAeA,CAACI,KAAiE;IACxF,OAAOjD,MAAM,CAACyE,IAAI,CAAC,MAAK;MACtB,KAAK,MAAM,CAACpC,OAAO,EAAEC,aAAa,CAAC,IAAIW,KAAK,EAAE;QAC5C/C,cAAc,CAACkB,GAAG,CAACc,WAAW,EAAEG,OAAO,EAAEC,aAAa,CAAC;MACzD;IACF,CAAC,CAAC;EACJ;EAEA,SAASqB,WAAWA,CAACV,KAAiD;IACpE,OAAOjD,MAAM,CAACyE,IAAI,CAAC,MAAK;MACtB,KAAK,MAAM,CAAClB,OAAO,EAAEC,MAAM,CAAC,IAAIP,KAAK,EAAE;QACrC/C,cAAc,CAACkB,GAAG,CAACgC,OAAO,EAAEG,OAAO,EAAEC,MAAM,CAAC;MAC9C;IACF,CAAC,CAAC;EACJ;EAEA,IAAIkB,QAAQ,GAAmB,EAAE;EAEjC,OAAOhD,YAAY,CAACK,EAAE,CAAC;IACrBC,cAAc,EAAEhC,MAAM,CAACyE,IAAI,CAAC,MAAMZ,KAAK,CAACC,IAAI,CAAC5B,WAAW,CAAC,CAAC;IAC1DW,eAAe;IACfK,UAAU,EAAElD,MAAM,CAACyE,IAAI,CAAC,MAAMZ,KAAK,CAACC,IAAI,CAACV,OAAO,CAAC,CAAC;IAClDO,WAAW;IACXK,OAAO,EAAEA,CAACY,QAAQ,EAAEX,QAAQ,KAAI;MAC9BS,QAAQ,GAAGb,KAAK,CAACC,IAAI,CAACG,QAAQ,CAAC;MAC/B,OAAOjE,MAAM,CAAC6E,OAAO,CAAChB,KAAK,CAACC,IAAI,CAACG,QAAQ,CAAC,CAAC;IAC7C,CAAC;IACDI,OAAO,EAAEA,CAAA,KAAMrE,MAAM,CAACyE,IAAI,CAAC,MAAMC,QAAQ,CAAC;IAC1CJ,OAAO,EAAEA,CAAA,KAAMtE,MAAM,CAAC2E,IAAI;IAC1BJ,UAAU,EAAEA,CAAA,KAAMvE,MAAM,CAAC2E;GAC1B,CAAC;AACJ,CAAC,CAAC;AAEF;;;;AAIO,MAAMI,WAAW,GAAAnD,OAAA,CAAAmD,WAAA,gBAA8B9E,KAAK,CAAC+E,MAAM,CAACtD,YAAY,EAAEoD,UAAU,CAAC;AAE5F;AACA;AACA;AAEA,MAAM9B,mBAAmB,GAAIV,aAA4B,IAAK,GAAGA,aAAa,CAAC2C,IAAI,IAAI3C,aAAa,CAAC4C,IAAI,EAAE;AAE3G,MAAMtC,mBAAmB,GAAIN,aAAqB,IAAmB;EACnE,MAAM,CAAC2C,IAAI,EAAEC,IAAI,CAAC,GAAG5C,aAAa,CAAC6C,KAAK,CAAC,GAAG,CAAC;EAC7C,OAAO,IAAIC,4BAAa,CAAC;IAAEH,IAAI;IAAEC,IAAI,EAAEG,MAAM,CAACH,IAAI;EAAC,CAAE,CAAC;AACxD,CAAC","ignoreList":[]}