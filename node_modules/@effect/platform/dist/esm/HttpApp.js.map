{"version":3,"file":"HttpApp.js","names":["Context","Effect","Exit","Fiber","GlobalValue","Layer","Option","Runtime","Scope","Stream","unify","HttpBody","ServerError","ServerRequest","ServerResponse","internal","internalMiddleware","handledSymbol","Symbol","for","toHandled","self","handleResponse","middleware","responded","withFiberRuntime","fiber","flatMap","response","request","unsafeGet","currentContext","HttpServerRequest","handler","getFiberRef","currentPreResponseHandlers","_tag","as","tap","value","withErrorHandling","catchAllCause","cause","causeResponse","zipRight","failCause","withMiddleware","undefined","tracer","matchCauseEffect","onFailure","void","_cause","empty","status","onSuccess","uninterruptible","scoped","ejectDefaultScopeClose","scope","ejectedScopes","add","unsafeEjectStreamScope","body","getOrThrow","getCurrentFiber","setBody","stream","ensuring","close","contentType","contentLength","globalValue","WeakSet","effect","make","onExit","extend","exit","has","appendPreResponseHandler","withPreResponseHandler","toWebHandlerRuntime","runtime","httpRuntime","run","runFork","resolveSymbol","httpApp","toWeb","withoutBody","method","context","Promise","resolve","contextMap","Map","unsafeMap","isContext","key","set","httpServerRequest","fromWeb","unsafeMake","signal","addEventListener","unsafeInterruptAsFork","clientAbortFiberId","once","toWebHandler","defaultRuntime","toWebHandlerLayerWith","layer","options","runSync","dispose","runPromise","handlerCache","handlerPromise","gen","memoMap","toRuntimeWithMemoMap","toRuntime","toHandler","pipe","then","f","toWebHandlerLayer","succeed"],"sources":["../../src/HttpApp.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}