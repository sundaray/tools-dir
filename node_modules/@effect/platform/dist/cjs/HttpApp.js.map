{"version":3,"file":"HttpApp.js","names":["Context","_interopRequireWildcard","require","Effect","Exit","Fiber","GlobalValue","Layer","Option","Runtime","Scope","Stream","_Unify","HttpBody","ServerError","ServerRequest","ServerResponse","internal","internalMiddleware","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","handledSymbol","Symbol","for","toHandled","self","handleResponse","middleware","responded","withFiberRuntime","fiber","flatMap","response","request","unsafeGet","currentContext","HttpServerRequest","handler","getFiberRef","currentPreResponseHandlers","_tag","as","tap","value","withErrorHandling","catchAllCause","cause","causeResponse","zipRight","failCause","withMiddleware","unify","undefined","tracer","matchCauseEffect","onFailure","void","_cause","empty","status","onSuccess","uninterruptible","scoped","exports","ejectDefaultScopeClose","scope","ejectedScopes","add","unsafeEjectStreamScope","body","getOrThrow","getCurrentFiber","setBody","stream","ensuring","close","contentType","contentLength","globalValue","WeakSet","effect","make","onExit","extend","exit","appendPreResponseHandler","withPreResponseHandler","toWebHandlerRuntime","runtime","httpRuntime","run","runFork","resolveSymbol","httpApp","toWeb","withoutBody","method","context","Promise","resolve","contextMap","Map","unsafeMap","isContext","key","httpServerRequest","fromWeb","unsafeMake","signal","addEventListener","unsafeInterruptAsFork","clientAbortFiberId","once","toWebHandler","defaultRuntime","toWebHandlerLayerWith","layer","options","runSync","dispose","runPromise","handlerCache","handlerPromise","gen","memoMap","toRuntimeWithMemoMap","toRuntime","toHandler","pipe","then","toWebHandlerLayer","succeed"],"sources":["../../src/HttpApp.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}